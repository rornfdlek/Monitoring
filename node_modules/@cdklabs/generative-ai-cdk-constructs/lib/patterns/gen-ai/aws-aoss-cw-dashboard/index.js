"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AossCwDashboard = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const aws_cdk_lib_1 = require("aws-cdk-lib");
const aws_cloudwatch_1 = require("aws-cdk-lib/aws-cloudwatch");
const constructs_1 = require("constructs");
/**
 * The BedrockCwDashboard class.
 */
class AossCwDashboard extends constructs_1.Construct {
    /**
     * Constructs a new instance of the AossCwDashboard class.
     * @param {cdk.App} scope - represents the scope for all the resources.
     * @param {string} id - this is a a scope-unique id.
     * @param {AossCwDashboardProps} props - user provided props for the construct.
     * @since 0.0.0
     * @public
     */
    constructor(scope, id, props) {
        super(scope, id);
        this.dashboard = props.existingDashboard ?? new aws_cloudwatch_1.Dashboard(this, 'AossMetricsDashboard', {
            dashboardName: props.dashboardName ?? 'AossMetricsDashboard',
        });
    }
    /* Provide metrics for a specific aoss collection
     * @param {string} collectionName - Name of the aoss collection to monitor.
     * @param {string} collectionId - Id of the aoss collection to monitor.
     * @param {CollectionMonitoringProps} props - user provided props for monitoring.
    */
    addCollectionMonitoringbyAttributes(collectionName, collectionId, props) {
        const period = props.period ?? aws_cdk_lib_1.Duration.hours(1);
        const clientId = props.clientId ?? aws_cdk_lib_1.Aws.ACCOUNT_ID;
        const dimensionMap = {
            ClientId: clientId,
            CollectionId: collectionId,
            CollectionName: collectionName,
        };
        this.dashboard.addWidgets(new aws_cloudwatch_1.TextWidget({
            markdown: '# OpenSearch Vector Database (collection level)',
            width: 24,
        }));
        // Response codes
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'OpenSearch response codes',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [
                new aws_cloudwatch_1.Metric({
                    metricName: '2xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '3xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '4xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '5xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
            ],
        }));
        // Search
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Search Request Latency',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchRequestLatency',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Search Request Errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchRequestErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        // Ingestion
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Successes',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestSuccess',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Latency',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestLatency',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
    }
    /* Provide metrics for a specific aoss collection
     * @param {string} collection - CfnCollection to monitor.
     * @param {CollectionMonitoringProps} props - user provided props for monitoring.
    */
    addCollectionMonitoringByCollection(collection, props) {
        this.addCollectionMonitoringbyAttributes(collection.name, collection.attrId, props);
    }
    /* Provide metrics for a specific aoss index
     * @param {string} collectionName - Name of the aoss collection to monitor.
     * @param {string} collectionId - Id of the aoss collection to monitor.
     * @param {string} IndexName - Name of the aoss index to monitor.
     * @param {string} IndexId - Id of the aoss index to monitor.
     * @param {IndexMonitoringProps} props - user provided props for monitoring.
    */
    addIndexMonitoringByAtributes(collectionName, collectionId, IndexName, IndexId, props) {
        const period = props.period ?? aws_cdk_lib_1.Duration.hours(1);
        const clientId = props.clientId ?? aws_cdk_lib_1.Aws.ACCOUNT_ID;
        const dimensionMap = {
            ClientId: clientId,
            CollectionId: collectionId,
            CollectionName: collectionName,
            IndexId: IndexId,
            IndexName: IndexName,
        };
        this.dashboard.addWidgets(new aws_cloudwatch_1.TextWidget({
            markdown: '# OpenSearch Vector Database (index level)',
            width: 24,
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Deleted documents',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'DeletedDocuments',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Searchable documents',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchableDocuments',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'S3 storage consumption',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'StorageUsedInS3',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Document ingestion rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDocumentRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDocumentErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Document data rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDataRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
    }
}
exports.AossCwDashboard = AossCwDashboard;
_a = JSII_RTTI_SYMBOL_1;
AossCwDashboard[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.AossCwDashboard", version: "0.1.285" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGF0dGVybnMvZ2VuLWFpL2F3cy1hb3NzLWN3LWRhc2hib2FyZC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7Ozs7Ozs7OztHQVdHO0FBQ0gsNkNBQTRDO0FBQzVDLCtEQU9vQztBQUVwQywyQ0FBdUM7QUEyRHZDOztHQUVHO0FBQ0gsTUFBYSxlQUFnQixTQUFRLHNCQUFTO0lBTzVDOzs7Ozs7O09BT0c7SUFDSCxZQUFZLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQTJCO1FBQ25FLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFakIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUMsaUJBQWlCLElBQUksSUFBSSwwQkFBUyxDQUFDLElBQUksRUFBRSxzQkFBc0IsRUFBRTtZQUN0RixhQUFhLEVBQUUsS0FBSyxDQUFDLGFBQWEsSUFBSSxzQkFBc0I7U0FDN0QsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOzs7O01BSUU7SUFDSyxtQ0FBbUMsQ0FBQyxjQUFzQixFQUFFLFlBQW9CLEVBQUUsS0FBZ0M7UUFFdkgsTUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sSUFBSSxzQkFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNqRCxNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxJQUFJLGlCQUFHLENBQUMsVUFBVSxDQUFDO1FBRWxELE1BQU0sWUFBWSxHQUFHO1lBQ25CLFFBQVEsRUFBRSxRQUFRO1lBQ2xCLFlBQVksRUFBRSxZQUFZO1lBQzFCLGNBQWMsRUFBRSxjQUFjO1NBQy9CLENBQUM7UUFFRixJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxJQUFJLDJCQUFVLENBQUM7WUFDdkMsUUFBUSxFQUFFLGlEQUFpRDtZQUMzRCxLQUFLLEVBQUUsRUFBRTtTQUNWLENBQUMsQ0FB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LDRCQUFXLENBQUM7WUFDZCxLQUFLLEVBQUUsa0JBQWtCO1lBQ3pCLElBQUksRUFBRSxnQ0FBZSxDQUFDLFdBQVc7WUFDakMsS0FBSyxFQUFFLEVBQUU7WUFDVCxJQUFJLEVBQUUsQ0FBQyxJQUFJLHVCQUFNLENBQUM7b0JBQ2hCLFVBQVUsRUFBRSx5QkFBeUI7b0JBQ3JDLFNBQVMsRUFBRSxVQUFVO29CQUNyQixTQUFTLEVBQUUsc0JBQUssQ0FBQyxHQUFHO29CQUNwQixhQUFhLEVBQUUsWUFBWTtvQkFDM0IsTUFBTSxFQUFFLE1BQU07aUJBQ2YsQ0FBQyxDQUFDO1NBQ0osQ0FBQyxFQUNGLElBQUksNEJBQVcsQ0FBQztZQUNkLEtBQUssRUFBRSxvQkFBb0I7WUFDM0IsSUFBSSxFQUFFLGdDQUFlLENBQUMsV0FBVztZQUNqQyxLQUFLLEVBQUUsRUFBRTtZQUNULElBQUksRUFBRSxDQUFDLElBQUksdUJBQU0sQ0FBQztvQkFDaEIsVUFBVSxFQUFFLG1CQUFtQjtvQkFDL0IsU0FBUyxFQUFFLFVBQVU7b0JBQ3JCLFNBQVMsRUFBRSxzQkFBSyxDQUFDLEdBQUc7b0JBQ3BCLGFBQWEsRUFBRSxZQUFZO29CQUMzQixNQUFNLEVBQUUsTUFBTTtpQkFDZixDQUFDLENBQUM7U0FDSixDQUFDLENBQ0gsQ0FBQztJQUVKLENBQUM7O0FBL1JILDBDQWdTQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogIENvcHlyaWdodCBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLiBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiAgd2l0aCB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqICBvciBpbiB0aGUgJ2xpY2Vuc2UnIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICdBUyBJUycgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFU1xuICogIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXG4gKiAgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBEdXJhdGlvbiwgQXdzIH0gZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0IHtcbiAgTWV0cmljLFxuICBEYXNoYm9hcmQsXG4gIEdyYXBoV2lkZ2V0LFxuICBHcmFwaFdpZGdldFZpZXcsXG4gIFN0YXRzLFxuICBUZXh0V2lkZ2V0LFxufSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtY2xvdWR3YXRjaCc7XG5pbXBvcnQgeyBDZm5Db2xsZWN0aW9uIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLW9wZW5zZWFyY2hzZXJ2ZXJsZXNzJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuXG5cbi8qKlxuICogVGhlIHByb3BlcnRpZXMgZm9yIHRoZSBDb2xsZWN0aW9uTW9uaXRvcmluZ1Byb3BzIGNsYXNzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIENvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHMge1xuICAvKlxuICAgICogT3B0aW9uYWwgLSBUaGUgcGVyaW9kIG92ZXIgd2hpY2ggdGhlIHNwZWNpZmllZCBzdGF0aXN0aWMgaXMgYXBwbGllZC5cbiAgICAqIEBkZWZhdWx0IC0gMSBob3VyXG4gICAgKi9cbiAgcmVhZG9ubHkgcGVyaW9kPzogRHVyYXRpb247XG5cbiAgLypcbiAgICAqIE9wdGlvbmFsIC0gVGhlIGNsaWVudCBJRCB0byB1c2UuXG4gICAgKiBAZGVmYXVsdCAtIEFjY291bnQgSURcbiAgICAqL1xuICByZWFkb25seSBjbGllbnRJZD86IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgcHJvcGVydGllcyBmb3IgdGhlIENvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHMgY2xhc3MuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSW5kZXhNb25pdG9yaW5nUHJvcHMge1xuICAvKlxuICAgICogT3B0aW9uYWwgLSBUaGUgcGVyaW9kIG92ZXIgd2hpY2ggdGhlIHNwZWNpZmllZCBzdGF0aXN0aWMgaXMgYXBwbGllZC5cbiAgICAqIEBkZWZhdWx0IC0gMSBob3VyXG4gICAgKi9cbiAgcmVhZG9ubHkgcGVyaW9kPzogRHVyYXRpb247XG4gIC8qXG4gICAgKiBPcHRpb25hbCAtIFRoZSBjbGllbnQgSUQgdG8gdXNlLlxuICAgICogQGRlZmF1bHQgLSBBY2NvdW50IElEXG4gICAgKi9cbiAgcmVhZG9ubHkgY2xpZW50SWQ/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogVGhlIHByb3BlcnRpZXMgZm9yIHRoZSBCZWRyb2NrQ3dEYXNoYm9hcmRQcm9wcyBjbGFzcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBb3NzQ3dEYXNoYm9hcmRQcm9wcyB7XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIEFuIGV4aXN0aW5nIGRhc2hib2FyZCB3aGVyZSBtZXRyaWNzIHdpbGwgYmUgYWRkZWQgdG8uXG4gICAqIElmIG5vdCBwcm92aWRlZCwgdGhlIGNvbnN0cnVjdCB3aWxsIGNyZWF0ZSBhIG5ldyBkYXNoYm9hcmRcbiAgICpcbiAgICogQGRlZmF1bHQgLSBub25lXG4gICAqL1xuICByZWFkb25seSBleGlzdGluZ0Rhc2hib2FyZD86IERhc2hib2FyZDtcblxuICAvKipcbiAgICogT3B0aW9uYWwgQSBuYW1lIGZvciB0aGUgZGFzaGJvYXJkIHdoaWNoIHdpbGwgYmUgY3JlYXRlZC5cbiAgICogSWYgZXhpc3RpbmdEYXNoYm9hcmQgaXMgZGVmaW5lZCwgdGhpcyB2YWx1ZSB3aWxsIGJlIGlnbm9yZWQuXG4gICAqIElmIG5vdCBwcm92aWRlZCwgdGhlIGNvbnN0cnVjdCB3aWxsIGNyZWF0ZSBhIG5ldyBkYXNoYm9hcmQgbmFtZWQgJ0JlZHJvY2tNZXRyaWNzRGFzaGJvYXJkJ1xuICAgKlxuICAgKiBAZGVmYXVsdCAtIG5vbmVcbiAgICovXG4gIHJlYWRvbmx5IGRhc2hib2FyZE5hbWU/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogVGhlIEJlZHJvY2tDd0Rhc2hib2FyZCBjbGFzcy5cbiAqL1xuZXhwb3J0IGNsYXNzIEFvc3NDd0Rhc2hib2FyZCBleHRlbmRzIENvbnN0cnVjdCB7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGluc3RhbmNlIG9mIENsb3VkV2F0Y2ggZGFzaGJvYXJkIHVzZWQgYnkgdGhlIGNvbnN0cnVjdFxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGRhc2hib2FyZDogRGFzaGJvYXJkO1xuXG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBBb3NzQ3dEYXNoYm9hcmQgY2xhc3MuXG4gICAqIEBwYXJhbSB7Y2RrLkFwcH0gc2NvcGUgLSByZXByZXNlbnRzIHRoZSBzY29wZSBmb3IgYWxsIHRoZSByZXNvdXJjZXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIHRoaXMgaXMgYSBhIHNjb3BlLXVuaXF1ZSBpZC5cbiAgICogQHBhcmFtIHtBb3NzQ3dEYXNoYm9hcmRQcm9wc30gcHJvcHMgLSB1c2VyIHByb3ZpZGVkIHByb3BzIGZvciB0aGUgY29uc3RydWN0LlxuICAgKiBAc2luY2UgMC4wLjBcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM6IEFvc3NDd0Rhc2hib2FyZFByb3BzKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkKTtcblxuICAgIHRoaXMuZGFzaGJvYXJkID0gcHJvcHMuZXhpc3RpbmdEYXNoYm9hcmQgPz8gbmV3IERhc2hib2FyZCh0aGlzLCAnQW9zc01ldHJpY3NEYXNoYm9hcmQnLCB7XG4gICAgICBkYXNoYm9hcmROYW1lOiBwcm9wcy5kYXNoYm9hcmROYW1lID8/ICdBb3NzTWV0cmljc0Rhc2hib2FyZCcsXG4gICAgfSk7XG4gIH1cblxuICAvKiBQcm92aWRlIG1ldHJpY3MgZm9yIGEgc3BlY2lmaWMgYW9zcyBjb2xsZWN0aW9uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjb2xsZWN0aW9uTmFtZSAtIE5hbWUgb2YgdGhlIGFvc3MgY29sbGVjdGlvbiB0byBtb25pdG9yLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbklkIC0gSWQgb2YgdGhlIGFvc3MgY29sbGVjdGlvbiB0byBtb25pdG9yLlxuICAgKiBAcGFyYW0ge0NvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHN9IHByb3BzIC0gdXNlciBwcm92aWRlZCBwcm9wcyBmb3IgbW9uaXRvcmluZy5cbiAgKi9cbiAgcHVibGljIGFkZENvbGxlY3Rpb25Nb25pdG9yaW5nYnlBdHRyaWJ1dGVzKGNvbGxlY3Rpb25OYW1lOiBzdHJpbmcsIGNvbGxlY3Rpb25JZDogc3RyaW5nLCBwcm9wczogQ29sbGVjdGlvbk1vbml0b3JpbmdQcm9wcykge1xuXG4gICAgY29uc3QgcGVyaW9kID0gcHJvcHMucGVyaW9kID8/IER1cmF0aW9uLmhvdXJzKDEpO1xuICAgIGNvbnN0IGNsaWVudElkID0gcHJvcHMuY2xpZW50SWQgPz8gQXdzLkFDQ09VTlRfSUQ7XG5cbiAgICBjb25zdCBkaW1lbnNpb25NYXAgPSB7XG4gICAgICBDbGllbnRJZDogY2xpZW50SWQsXG4gICAgICBDb2xsZWN0aW9uSWQ6IGNvbGxlY3Rpb25JZCxcbiAgICAgIENvbGxlY3Rpb25OYW1lOiBjb2xsZWN0aW9uTmFtZSxcbiAgICB9O1xuXG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhuZXcgVGV4dFdpZGdldCh7XG4gICAgICBtYXJrZG93bjogJyMgT3BlblNlYXJjaCBWZWN0b3IgRGF0YWJhc2UgKGNvbGxlY3Rpb24gbGV2ZWwpJyxcbiAgICAgIHdpZHRoOiAyNCxcbiAgICB9KSk7XG5cbiAgICAvLyBSZXNwb25zZSBjb2Rlc1xuICAgIHRoaXMuZGFzaGJvYXJkLmFkZFdpZGdldHMoXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ09wZW5TZWFyY2ggcmVzcG9uc2UgY29kZXMnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW1xuICAgICAgICAgIG5ldyBNZXRyaWMoe1xuICAgICAgICAgICAgbWV0cmljTmFtZTogJzJ4eCcsXG4gICAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG5ldyBNZXRyaWMoe1xuICAgICAgICAgICAgbWV0cmljTmFtZTogJzN4eCcsXG4gICAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG5ldyBNZXRyaWMoe1xuICAgICAgICAgICAgbWV0cmljTmFtZTogJzR4eCcsXG4gICAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIG5ldyBNZXRyaWMoe1xuICAgICAgICAgICAgbWV0cmljTmFtZTogJzV4eCcsXG4gICAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICAgIH0pLFxuICAgICAgICBdLFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIC8vIFNlYXJjaFxuICAgIHRoaXMuZGFzaGJvYXJkLmFkZFdpZGdldHMoXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ1NlYXJjaCBSZXF1ZXN0IExhdGVuY3knLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdTZWFyY2hSZXF1ZXN0TGF0ZW5jeScsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuQVZFUkFHRSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdTZWFyY2ggUmVxdWVzdCBFcnJvcnMnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdTZWFyY2hSZXF1ZXN0RXJyb3JzJyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5TVU0sXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgLy8gSW5nZXN0aW9uXG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnSW5nZXN0aW9uIFJlcXVlc3QgU3VjY2Vzc2VzJyxcbiAgICAgICAgdmlldzogR3JhcGhXaWRnZXRWaWV3LlRJTUVfU0VSSUVTLFxuICAgICAgICB3aWR0aDogMTIsXG4gICAgICAgIGxlZnQ6IFtuZXcgTWV0cmljKHtcbiAgICAgICAgICBtZXRyaWNOYW1lOiAnSW5nZXN0aW9uUmVxdWVzdFN1Y2Nlc3MnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdJbmdlc3Rpb24gUmVxdWVzdCBSYXRlJyxcbiAgICAgICAgdmlldzogR3JhcGhXaWRnZXRWaWV3LlRJTUVfU0VSSUVTLFxuICAgICAgICB3aWR0aDogMTIsXG4gICAgICAgIGxlZnQ6IFtuZXcgTWV0cmljKHtcbiAgICAgICAgICBtZXRyaWNOYW1lOiAnSW5nZXN0aW9uUmVxdWVzdFJhdGUnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLkFWRVJBR0UsXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICApO1xuICAgIHRoaXMuZGFzaGJvYXJkLmFkZFdpZGdldHMoXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0luZ2VzdGlvbiBSZXF1ZXN0IExhdGVuY3knLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25SZXF1ZXN0TGF0ZW5jeScsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuQVZFUkFHRSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdJbmdlc3Rpb24gUmVxdWVzdCBFcnJvcnMnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25SZXF1ZXN0RXJyb3JzJyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5TVU0sXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICApO1xuXG5cbiAgfVxuXG4gIC8qIFByb3ZpZGUgbWV0cmljcyBmb3IgYSBzcGVjaWZpYyBhb3NzIGNvbGxlY3Rpb25cbiAgICogQHBhcmFtIHtzdHJpbmd9IGNvbGxlY3Rpb24gLSBDZm5Db2xsZWN0aW9uIHRvIG1vbml0b3IuXG4gICAqIEBwYXJhbSB7Q29sbGVjdGlvbk1vbml0b3JpbmdQcm9wc30gcHJvcHMgLSB1c2VyIHByb3ZpZGVkIHByb3BzIGZvciBtb25pdG9yaW5nLlxuICAqL1xuICBwdWJsaWMgYWRkQ29sbGVjdGlvbk1vbml0b3JpbmdCeUNvbGxlY3Rpb24oY29sbGVjdGlvbjogQ2ZuQ29sbGVjdGlvbiwgcHJvcHM6IENvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHMpIHtcblxuICAgIHRoaXMuYWRkQ29sbGVjdGlvbk1vbml0b3JpbmdieUF0dHJpYnV0ZXMoY29sbGVjdGlvbi5uYW1lLCBjb2xsZWN0aW9uLmF0dHJJZCwgcHJvcHMpO1xuXG4gIH1cblxuICAvKiBQcm92aWRlIG1ldHJpY3MgZm9yIGEgc3BlY2lmaWMgYW9zcyBpbmRleFxuICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbk5hbWUgLSBOYW1lIG9mIHRoZSBhb3NzIGNvbGxlY3Rpb24gdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGNvbGxlY3Rpb25JZCAtIElkIG9mIHRoZSBhb3NzIGNvbGxlY3Rpb24gdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtzdHJpbmd9IEluZGV4TmFtZSAtIE5hbWUgb2YgdGhlIGFvc3MgaW5kZXggdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtzdHJpbmd9IEluZGV4SWQgLSBJZCBvZiB0aGUgYW9zcyBpbmRleCB0byBtb25pdG9yLlxuICAgKiBAcGFyYW0ge0luZGV4TW9uaXRvcmluZ1Byb3BzfSBwcm9wcyAtIHVzZXIgcHJvdmlkZWQgcHJvcHMgZm9yIG1vbml0b3JpbmcuXG4gICovXG4gIHB1YmxpYyBhZGRJbmRleE1vbml0b3JpbmdCeUF0cmlidXRlcyhcbiAgICBjb2xsZWN0aW9uTmFtZTogc3RyaW5nLFxuICAgIGNvbGxlY3Rpb25JZDogc3RyaW5nLFxuICAgIEluZGV4TmFtZTogc3RyaW5nLFxuICAgIEluZGV4SWQ6IHN0cmluZyxcbiAgICBwcm9wczogSW5kZXhNb25pdG9yaW5nUHJvcHMsXG4gICkge1xuXG4gICAgY29uc3QgcGVyaW9kID0gcHJvcHMucGVyaW9kID8/IER1cmF0aW9uLmhvdXJzKDEpO1xuICAgIGNvbnN0IGNsaWVudElkID0gcHJvcHMuY2xpZW50SWQgPz8gQXdzLkFDQ09VTlRfSUQ7XG5cbiAgICBjb25zdCBkaW1lbnNpb25NYXAgPSB7XG4gICAgICBDbGllbnRJZDogY2xpZW50SWQsXG4gICAgICBDb2xsZWN0aW9uSWQ6IGNvbGxlY3Rpb25JZCxcbiAgICAgIENvbGxlY3Rpb25OYW1lOiBjb2xsZWN0aW9uTmFtZSxcbiAgICAgIEluZGV4SWQ6IEluZGV4SWQsXG4gICAgICBJbmRleE5hbWU6IEluZGV4TmFtZSxcbiAgICB9O1xuXG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhuZXcgVGV4dFdpZGdldCh7XG4gICAgICBtYXJrZG93bjogJyMgT3BlblNlYXJjaCBWZWN0b3IgRGF0YWJhc2UgKGluZGV4IGxldmVsKScsXG4gICAgICB3aWR0aDogMjQsXG4gICAgfSkpO1xuICAgIHRoaXMuZGFzaGJvYXJkLmFkZFdpZGdldHMoXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0RlbGV0ZWQgZG9jdW1lbnRzJyxcbiAgICAgICAgdmlldzogR3JhcGhXaWRnZXRWaWV3LlRJTUVfU0VSSUVTLFxuICAgICAgICB3aWR0aDogMTIsXG4gICAgICAgIGxlZnQ6IFtuZXcgTWV0cmljKHtcbiAgICAgICAgICBtZXRyaWNOYW1lOiAnRGVsZXRlZERvY3VtZW50cycsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ1NlYXJjaGFibGUgZG9jdW1lbnRzJyxcbiAgICAgICAgdmlldzogR3JhcGhXaWRnZXRWaWV3LlRJTUVfU0VSSUVTLFxuICAgICAgICB3aWR0aDogMTIsXG4gICAgICAgIGxlZnQ6IFtuZXcgTWV0cmljKHtcbiAgICAgICAgICBtZXRyaWNOYW1lOiAnU2VhcmNoYWJsZURvY3VtZW50cycsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgKTtcbiAgICB0aGlzLmRhc2hib2FyZC5hZGRXaWRnZXRzKFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdTMyBzdG9yYWdlIGNvbnN1bXB0aW9uJyxcbiAgICAgICAgdmlldzogR3JhcGhXaWRnZXRWaWV3LlRJTUVfU0VSSUVTLFxuICAgICAgICB3aWR0aDogMTIsXG4gICAgICAgIGxlZnQ6IFtuZXcgTWV0cmljKHtcbiAgICAgICAgICBtZXRyaWNOYW1lOiAnU3RvcmFnZVVzZWRJblMzJyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5TVU0sXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnRG9jdW1lbnQgaW5nZXN0aW9uIHJhdGUnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25Eb2N1bWVudFJhdGUnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnSW5nZXN0aW9uIGVycm9ycycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ0luZ2VzdGlvbkRvY3VtZW50RXJyb3JzJyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5TVU0sXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnRG9jdW1lbnQgZGF0YSByYXRlJyxcbiAgICAgICAgdmlldzogR3JhcGhXaWRnZXRWaWV3LlRJTUVfU0VSSUVTLFxuICAgICAgICB3aWR0aDogMTIsXG4gICAgICAgIGxlZnQ6IFtuZXcgTWV0cmljKHtcbiAgICAgICAgICBtZXRyaWNOYW1lOiAnSW5nZXN0aW9uRGF0YVJhdGUnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgfVxufVxuXG4iXX0=