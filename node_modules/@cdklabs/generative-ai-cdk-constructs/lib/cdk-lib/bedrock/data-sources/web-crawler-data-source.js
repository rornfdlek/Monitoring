"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.WebCrawlerDataSource = exports.CrawlingScope = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const aws_bedrock_1 = require("aws-cdk-lib/aws-bedrock");
const base_data_source_1 = require("./base-data-source");
const utils_1 = require("../../../common/helpers/utils");
/**
 * The scope of the crawling.
 */
var CrawlingScope;
(function (CrawlingScope) {
    /**
     * Crawls only web pages that belong to the same host or primary domain.
     */
    CrawlingScope["HOST_ONLY"] = "HOST_ONLY";
    /**
     * Includes subdomains in addition to the host or primary domain, i.e.
     * web pages that contain "aws.amazon.com" can also include
     * sub domain "docs.aws.amazon.com"
     */
    CrawlingScope["SUBDOMAINS"] = "SUBDOMAINS";
    /**
     * Limit crawling to web pages that belong to the same host and with the
     * same initial URL path.
     */
    CrawlingScope["DEFAULT"] = "DEFAULT";
})(CrawlingScope || (exports.CrawlingScope = CrawlingScope = {}));
/**
 * Sets up a web crawler data source to be added to a knowledge base.
 */
class WebCrawlerDataSource extends base_data_source_1.DataSourceNew {
    constructor(scope, id, props) {
        super(scope, id);
        // Assign attributes
        this.knowledgeBase = props.knowledgeBase;
        this.dataSourceType = base_data_source_1.DataSourceType.WEB_CRAWLER;
        this.dataSourceName = props.dataSourceName ?? (0, utils_1.generatePhysicalNameV2)(this, 'crawler-ds', { maxLength: 40, lower: true, separator: '-' });
        ;
        this.kmsKey = props.kmsKey;
        this.crawlingRate = props.crawlingRate ?? 300;
        this.siteUrls = props.sourceUrls;
        // ------------------------------------------------------
        // Manage permissions for the data source
        // ------------------------------------------------------
        this.handleCommonPermissions(props);
        // ------------------------------------------------------
        // L1 Instantiation
        // ------------------------------------------------------
        this.__resource = new aws_bedrock_1.CfnDataSource(this, 'DataSource', {
            ...this.formatAsCfnProps(props, {
                type: this.dataSourceType,
                webConfiguration: {
                    crawlerConfiguration: {
                        crawlerLimits: {
                            rateLimit: this.crawlingRate,
                        },
                        scope: (props.crawlingScope !== CrawlingScope.DEFAULT) ? props.crawlingScope : undefined, //?? CrawlingScope.HOST_ONLY,
                        inclusionFilters: props.filters?.includePatterns,
                        exclusionFilters: props.filters?.excludePatterns,
                    },
                    sourceConfiguration: {
                        urlConfiguration: {
                            seedUrls: props.sourceUrls.map(item => ({ url: item })),
                        },
                    },
                },
            }),
        });
        this.dataSourceId = this.__resource.attrDataSourceId;
    }
}
exports.WebCrawlerDataSource = WebCrawlerDataSource;
_a = JSII_RTTI_SYMBOL_1;
WebCrawlerDataSource[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.bedrock.WebCrawlerDataSource", version: "0.1.285" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViLWNyYXdsZXItZGF0YS1zb3VyY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY2RrLWxpYi9iZWRyb2NrL2RhdGEtc291cmNlcy93ZWItY3Jhd2xlci1kYXRhLXNvdXJjZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7Ozs7Ozs7OztHQVdHO0FBQ0gseURBQXdEO0FBSXhELHlEQUErRjtBQUMvRix5REFBdUU7QUFHdkU7O0dBRUc7QUFDSCxJQUFZLGFBZ0JYO0FBaEJELFdBQVksYUFBYTtJQUN2Qjs7T0FFRztJQUNILHdDQUF1QixDQUFBO0lBQ3ZCOzs7O09BSUc7SUFDSCwwQ0FBeUIsQ0FBQTtJQUN6Qjs7O09BR0c7SUFDSCxvQ0FBbUIsQ0FBQTtBQUNyQixDQUFDLEVBaEJXLGFBQWEsNkJBQWIsYUFBYSxRQWdCeEI7QUF1REQ7O0dBRUc7QUFDSCxNQUFhLG9CQUFxQixTQUFRLGdDQUFhO0lBNENyRCxZQUFZLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQWdDO1FBQ3hFLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDakIsb0JBQW9CO1FBQ3BCLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDLGFBQWEsQ0FBQztRQUN6QyxJQUFJLENBQUMsY0FBYyxHQUFHLGlDQUFjLENBQUMsV0FBVyxDQUFDO1FBQ2pELElBQUksQ0FBQyxjQUFjLEdBQUcsS0FBSyxDQUFDLGNBQWMsSUFBSSxJQUFBLDhCQUFzQixFQUFDLElBQUksRUFBRSxZQUFZLEVBQUUsRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFBQSxDQUFDO1FBQzFJLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQztRQUMzQixJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQyxZQUFZLElBQUksR0FBRyxDQUFDO1FBQzlDLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQztRQUVqQyx5REFBeUQ7UUFDekQseUNBQXlDO1FBQ3pDLHlEQUF5RDtRQUN6RCxJQUFJLENBQUMsdUJBQXVCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFcEMseURBQXlEO1FBQ3pELG1CQUFtQjtRQUNuQix5REFBeUQ7UUFFekQsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLDJCQUFhLENBQUMsSUFBSSxFQUFFLFlBQVksRUFBRTtZQUN0RCxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FDdEIsS0FBSyxFQUNMO2dCQUNFLElBQUksRUFBRSxJQUFJLENBQUMsY0FBYztnQkFDekIsZ0JBQWdCLEVBQUU7b0JBQ2hCLG9CQUFvQixFQUFFO3dCQUNwQixhQUFhLEVBQUU7NEJBQ2IsU0FBUyxFQUFFLElBQUksQ0FBQyxZQUFZO3lCQUM3Qjt3QkFDRCxLQUFLLEVBQUUsQ0FBQyxLQUFLLENBQUMsYUFBYSxLQUFLLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLDZCQUE2Qjt3QkFDdkgsZ0JBQWdCLEVBQUUsS0FBSyxDQUFDLE9BQU8sRUFBRSxlQUFlO3dCQUNoRCxnQkFBZ0IsRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFFLGVBQWU7cUJBRWpEO29CQUNELG1CQUFtQixFQUFFO3dCQUNuQixnQkFBZ0IsRUFBRTs0QkFDaEIsUUFBUSxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO3lCQUN4RDtxQkFDRjtpQkFDRjthQUNGLENBQ0Y7U0FDRixDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsZ0JBQWdCLENBQUM7SUFHdkQsQ0FBQzs7QUEzRkgsb0RBNEZDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiAgQ29weXJpZ2h0IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqICB3aXRoIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YgdGhlIExpY2Vuc2UgaXMgbG9jYXRlZCBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogIG9yIGluIHRoZSAnbGljZW5zZScgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gJ0FTIElTJyBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTXG4gKiAgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqICBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IENmbkRhdGFTb3VyY2UgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYmVkcm9jayc7XG5pbXBvcnQgeyBJS2V5IH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWttcyc7XG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcblxuaW1wb3J0IHsgRGF0YVNvdXJjZU5ldywgRGF0YVNvdXJjZUFzc29jaWF0aW9uUHJvcHMsIERhdGFTb3VyY2VUeXBlIH0gZnJvbSAnLi9iYXNlLWRhdGEtc291cmNlJztcbmltcG9ydCB7IGdlbmVyYXRlUGh5c2ljYWxOYW1lVjIgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vaGVscGVycy91dGlscyc7XG5pbXBvcnQgeyBJS25vd2xlZGdlQmFzZSB9IGZyb20gJy4uL2tub3dsZWRnZS1iYXNlJztcblxuLyoqXG4gKiBUaGUgc2NvcGUgb2YgdGhlIGNyYXdsaW5nLlxuICovXG5leHBvcnQgZW51bSBDcmF3bGluZ1Njb3BlIHtcbiAgLyoqXG4gICAqIENyYXdscyBvbmx5IHdlYiBwYWdlcyB0aGF0IGJlbG9uZyB0byB0aGUgc2FtZSBob3N0IG9yIHByaW1hcnkgZG9tYWluLlxuICAgKi9cbiAgSE9TVF9PTkxZID0gJ0hPU1RfT05MWScsXG4gIC8qKlxuICAgKiBJbmNsdWRlcyBzdWJkb21haW5zIGluIGFkZGl0aW9uIHRvIHRoZSBob3N0IG9yIHByaW1hcnkgZG9tYWluLCBpLmUuXG4gICAqIHdlYiBwYWdlcyB0aGF0IGNvbnRhaW4gXCJhd3MuYW1hem9uLmNvbVwiIGNhbiBhbHNvIGluY2x1ZGVcbiAgICogc3ViIGRvbWFpbiBcImRvY3MuYXdzLmFtYXpvbi5jb21cIlxuICAgKi9cbiAgU1VCRE9NQUlOUyA9ICdTVUJET01BSU5TJyxcbiAgLyoqXG4gICAqIExpbWl0IGNyYXdsaW5nIHRvIHdlYiBwYWdlcyB0aGF0IGJlbG9uZyB0byB0aGUgc2FtZSBob3N0IGFuZCB3aXRoIHRoZVxuICAgKiBzYW1lIGluaXRpYWwgVVJMIHBhdGguXG4gICAqL1xuICBERUZBVUxUID0gJ0RFRkFVTFQnXG59XG5cbi8qKlxuICogVGhlIGZpbHRlcnMgKHJlZ3VsYXIgZXhwcmVzc2lvbiBwYXR0ZXJucykgdG8gaW5jbHVkZSBvciBleGNsdWRlIGluIHRoZSBjcmF3bGluZ1xuICogaW4gYWNjb3JkYW5jZSB3aXRoIHlvdXIgc2NvcGUuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ3Jhd2xpbmdGaWx0ZXJzIHtcbiAgLyoqXG4gICAqIEluY2x1ZGUgcGF0dGVybnMuXG4gICAqL1xuICByZWFkb25seSBpbmNsdWRlUGF0dGVybnM/OiBzdHJpbmdbXTtcbiAgLyoqXG4gICAqIEV4Y2x1ZGUgcGF0aHMuXG4gICAqL1xuICByZWFkb25seSBleGNsdWRlUGF0dGVybnM/OiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBJbnRlcmZhY2UgdG8gYWRkIGEgbmV3IGRhdGEgc291cmNlIHRvIGFuIGV4aXN0aW5nIEtCLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFdlYkNyYXdsZXJEYXRhU291cmNlQXNzb2NpYXRpb25Qcm9wcyBleHRlbmRzIERhdGFTb3VyY2VBc3NvY2lhdGlvblByb3BzIHtcbiAgLyoqXG4gICAqIFRoZSBzb3VyY2UgdXJscyBpbiB0aGUgZm9ybWF0IGBodHRwczovL3d3dy5zaXRlbmFtZS5jb21gLlxuICAgKiBNYXhpbXVtIG9mIDEwMCBVUkxzLlxuICAgKi9cbiAgcmVhZG9ubHkgc291cmNlVXJsczogc3RyaW5nW107XG4gIC8qKlxuICAgKiBUaGUgc2NvcGUgb2YgdGhlIGNyYXdsaW5nLlxuICAgKiBAZGVmYXVsdCAtIENyYXdsaW5nU2NvcGUuREVGQVVMVFxuICAgKi9cbiAgcmVhZG9ubHkgY3Jhd2xpbmdTY29wZT86IENyYXdsaW5nU2NvcGU7XG4gIC8qKlxuICAgKiBUaGUgbWF4IHJhdGUgYXQgd2hpY2ggcGFnZXMgYXJlIGNyYXdsZWQsIHVwIHRvIDMwMCBwZXIgbWludXRlIHBlciBob3N0LlxuICAgKiBIaWdoZXIgdmFsdWVzIHdpbGwgZGVjcmVhc2Ugc3luYyB0aW1lIGJ1dCBpbmNyZWFzZSB0aGUgbG9hZCBvbiB0aGUgaG9zdC5cbiAgICogQGRlZmF1bHQgMzAwXG4gICAqL1xuICByZWFkb25seSBjcmF3bGluZ1JhdGU/OiBudW1iZXI7XG4gIC8qKlxuICAgKiBUaGUgZmlsdGVycyAocmVndWxhciBleHByZXNzaW9uIHBhdHRlcm5zKSBmb3IgdGhlIGNyYXdsaW5nLlxuICAgKiBJZiB0aGVyZSdzIGEgY29uZmxpY3QsIHRoZSBleGNsdWRlIHBhdHRlcm4gdGFrZXMgcHJlY2VkZW5jZS5cbiAgICogQGRlZmF1bHQgTm9uZVxuICAgKi9cbiAgcmVhZG9ubHkgZmlsdGVycz86IENyYXdsaW5nRmlsdGVycztcbn1cblxuLyoqXG4gKiBJbnRlcmZhY2UgdG8gY3JlYXRlIGEgbmV3IHN0YW5kYWxvbmUgZGF0YSBzb3VyY2Ugb2JqZWN0LlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFdlYkNyYXdsZXJEYXRhU291cmNlUHJvcHMgZXh0ZW5kcyBXZWJDcmF3bGVyRGF0YVNvdXJjZUFzc29jaWF0aW9uUHJvcHMge1xuICAvKipcbiAgICogVGhlIGtub3dsZWRnZSBiYXNlIHRvIGFzc29jaWF0ZSB3aXRoIHRoZSBkYXRhIHNvdXJjZS5cbiAgICovXG4gIHJlYWRvbmx5IGtub3dsZWRnZUJhc2U6IElLbm93bGVkZ2VCYXNlO1xufVxuXG4vKipcbiAqIFNldHMgdXAgYSB3ZWIgY3Jhd2xlciBkYXRhIHNvdXJjZSB0byBiZSBhZGRlZCB0byBhIGtub3dsZWRnZSBiYXNlLlxuICovXG5leHBvcnQgY2xhc3MgV2ViQ3Jhd2xlckRhdGFTb3VyY2UgZXh0ZW5kcyBEYXRhU291cmNlTmV3IHtcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIENvbW1vbiBhdHRyaWJ1dGVzIGZvciBhbGwgbmV3IGRhdGEgc291cmNlc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgZGF0YSBzb3VyY2UuXG4gICAqIEBleGFtcGxlICdKSFVFVlhVWk1VJ1xuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGRhdGFTb3VyY2VJZDogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIHR5cGUgb2YgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgZGF0YVNvdXJjZVR5cGU6IERhdGFTb3VyY2VUeXBlO1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIGRhdGEgc291cmNlLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGRhdGFTb3VyY2VOYW1lOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUga25vd2xlZGdlIGJhc2UgYXNzb2NpYXRlZCB3aXRoIHRoZSBkYXRhIHNvdXJjZS5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBrbm93bGVkZ2VCYXNlOiBJS25vd2xlZGdlQmFzZTtcbiAgLyoqXG4gICAqIFRoZSBLTVMga2V5IHRvIHVzZSB0byBlbmNyeXB0IHRoZSBkYXRhIHNvdXJjZS5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBrbXNLZXk/OiBJS2V5O1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gVW5pcXVlIHRvIHRoaXMgY2xhc3NcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBUaGUgbWF4IHJhdGUgYXQgd2hpY2ggcGFnZXMgYXJlIGNyYXdsZWQuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgc2l0ZVVybHM6IHN0cmluZ1tdO1xuICAvKipcbiAgICogVGhlIG1heCByYXRlIGF0IHdoaWNoIHBhZ2VzIGFyZSBjcmF3bGVkLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGNyYXdsaW5nUmF0ZTogbnVtYmVyO1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gSW50ZXJuYWwgT25seVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFRoZSBEYXRhIFNvdXJjZSBjZm4gcmVzb3VyY2UuXG4gICAqL1xuICBwcml2YXRlIHJlYWRvbmx5IF9fcmVzb3VyY2U6IENmbkRhdGFTb3VyY2U7XG5cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM6IFdlYkNyYXdsZXJEYXRhU291cmNlUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQpO1xuICAgIC8vIEFzc2lnbiBhdHRyaWJ1dGVzXG4gICAgdGhpcy5rbm93bGVkZ2VCYXNlID0gcHJvcHMua25vd2xlZGdlQmFzZTtcbiAgICB0aGlzLmRhdGFTb3VyY2VUeXBlID0gRGF0YVNvdXJjZVR5cGUuV0VCX0NSQVdMRVI7XG4gICAgdGhpcy5kYXRhU291cmNlTmFtZSA9IHByb3BzLmRhdGFTb3VyY2VOYW1lID8/IGdlbmVyYXRlUGh5c2ljYWxOYW1lVjIodGhpcywgJ2NyYXdsZXItZHMnLCB7IG1heExlbmd0aDogNDAsIGxvd2VyOiB0cnVlLCBzZXBhcmF0b3I6ICctJyB9KTs7XG4gICAgdGhpcy5rbXNLZXkgPSBwcm9wcy5rbXNLZXk7XG4gICAgdGhpcy5jcmF3bGluZ1JhdGUgPSBwcm9wcy5jcmF3bGluZ1JhdGUgPz8gMzAwO1xuICAgIHRoaXMuc2l0ZVVybHMgPSBwcm9wcy5zb3VyY2VVcmxzO1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTWFuYWdlIHBlcm1pc3Npb25zIGZvciB0aGUgZGF0YSBzb3VyY2VcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICB0aGlzLmhhbmRsZUNvbW1vblBlcm1pc3Npb25zKHByb3BzKTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEwxIEluc3RhbnRpYXRpb25cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIHRoaXMuX19yZXNvdXJjZSA9IG5ldyBDZm5EYXRhU291cmNlKHRoaXMsICdEYXRhU291cmNlJywge1xuICAgICAgLi4udGhpcy5mb3JtYXRBc0NmblByb3BzKFxuICAgICAgICBwcm9wcyxcbiAgICAgICAge1xuICAgICAgICAgIHR5cGU6IHRoaXMuZGF0YVNvdXJjZVR5cGUsXG4gICAgICAgICAgd2ViQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgY3Jhd2xlckNvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICAgICAgY3Jhd2xlckxpbWl0czoge1xuICAgICAgICAgICAgICAgIHJhdGVMaW1pdDogdGhpcy5jcmF3bGluZ1JhdGUsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNjb3BlOiAocHJvcHMuY3Jhd2xpbmdTY29wZSAhPT0gQ3Jhd2xpbmdTY29wZS5ERUZBVUxUKSA/IHByb3BzLmNyYXdsaW5nU2NvcGUgOiB1bmRlZmluZWQsIC8vPz8gQ3Jhd2xpbmdTY29wZS5IT1NUX09OTFksXG4gICAgICAgICAgICAgIGluY2x1c2lvbkZpbHRlcnM6IHByb3BzLmZpbHRlcnM/LmluY2x1ZGVQYXR0ZXJucyxcbiAgICAgICAgICAgICAgZXhjbHVzaW9uRmlsdGVyczogcHJvcHMuZmlsdGVycz8uZXhjbHVkZVBhdHRlcm5zLFxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc291cmNlQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICB1cmxDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgc2VlZFVybHM6IHByb3BzLnNvdXJjZVVybHMubWFwKGl0ZW0gPT4gKHsgdXJsOiBpdGVtIH0pKSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICksXG4gICAgfSk7XG5cbiAgICB0aGlzLmRhdGFTb3VyY2VJZCA9IHRoaXMuX19yZXNvdXJjZS5hdHRyRGF0YVNvdXJjZUlkO1xuXG5cbiAgfVxufVxuIl19