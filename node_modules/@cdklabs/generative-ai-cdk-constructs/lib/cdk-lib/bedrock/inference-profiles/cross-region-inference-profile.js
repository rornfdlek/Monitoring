"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.CrossRegionInferenceProfile = exports.CrossRegionInferenceProfileRegion = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const aws_cdk_lib_1 = require("aws-cdk-lib");
const aws_iam_1 = require("aws-cdk-lib/aws-iam");
const common_1 = require("./common");
var CrossRegionInferenceProfileRegion;
(function (CrossRegionInferenceProfileRegion) {
    /**
     * Cross-region Inference Identifier for the European area.
     * According to the model chosen, this might include:
     * - Frankfurt (`eu-central-1`)
     * - Ireland (`eu-west-1`)
     * - Paris (`eu-west-3`)
     */
    CrossRegionInferenceProfileRegion["EU"] = "eu";
    /**
     * Cross-region Inference Identifier for the United States area.
     * According to the model chosen, this might include:
     * - N. Virginia (`us-east-1`)
     * - Oregon (`us-west-2`)
     * - Ohio (`us-east-2`)
     */
    CrossRegionInferenceProfileRegion["US"] = "us";
    /**
     * Cross-region Inference Identifier for the Asia-Pacific area.
     * According to the model chosen, this might include:
     * - Tokyo (`ap-northeast-1`)
     * - Seoul (`ap-northeast-2`)
     * - Mumbai (`ap-south-1`)
     * - Singapore (`ap-southeast-1`)
     * - Sydney (`ap-southeast-2`)
     */
    CrossRegionInferenceProfileRegion["APAC"] = "apac";
})(CrossRegionInferenceProfileRegion || (exports.CrossRegionInferenceProfileRegion = CrossRegionInferenceProfileRegion = {}));
/******************************************************************************
 *                        NEW CONSTRUCT DEFINITION
 *****************************************************************************/
/**
 * Cross-region inference enables you to seamlessly manage unplanned traffic
 * bursts by utilizing compute across different AWS Regions. With cross-region
 * inference, you can distribute traffic across multiple AWS Regions, enabling
 * higher throughput and enhanced resilience during periods of peak demands.
 * @see https://docs.aws.amazon.com/bedrock/latest/userguide/cross-region-inference.html
 */
class CrossRegionInferenceProfile {
    static fromConfig(config) {
        return new CrossRegionInferenceProfile(config);
    }
    constructor(props) {
        if (!props.model.supportsCrossRegion) {
            throw new Error(`Model ${props.model.modelId} does not support cross-region inference`);
        }
        this.type = common_1.InferenceProfileType.SYSTEM_DEFINED;
        this.inferenceProfileModel = props.model;
        this.inferenceProfileId = `${props.geoRegion}.${props.model.modelId}`;
        this.inferenceProfileArn = aws_cdk_lib_1.Arn.format({
            partition: aws_cdk_lib_1.Aws.PARTITION,
            service: 'bedrock',
            account: aws_cdk_lib_1.Aws.ACCOUNT_ID,
            region: aws_cdk_lib_1.Aws.REGION,
            resource: 'inference-profile',
            resourceName: this.inferenceProfileId,
            arnFormat: aws_cdk_lib_1.ArnFormat.SLASH_RESOURCE_NAME,
        });
        // Needed to Implement IInvokable
        this.invokableArn = this.inferenceProfileArn;
    }
    /**
     * Gives the appropriate policies to invoke and use the Foundation Model.
     */
    grantInvoke(grantee) {
        // for CRIS, we need to provide permissions to invoke the model in all regions
        // where the inference profile can route requests
        this.inferenceProfileModel.grantInvokeAllRegions(grantee);
        // and we need to provide permissions to invoke the inference profile itself
        return this.grantProfileUsage(grantee);
    }
    /**
     * Grants appropriate permissions to use the cross-region inference profile.
     * Does not grant permissions to use the model in the profile.
     */
    grantProfileUsage(grantee) {
        const grant = aws_iam_1.Grant.addToPrincipal({
            grantee: grantee,
            actions: ['bedrock:GetInferenceProfile', 'bedrock:InvokeModel'],
            resourceArns: [this.inferenceProfileArn],
        });
        return grant;
    }
}
exports.CrossRegionInferenceProfile = CrossRegionInferenceProfile;
_a = JSII_RTTI_SYMBOL_1;
CrossRegionInferenceProfile[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.bedrock.CrossRegionInferenceProfile", version: "0.1.285" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3Jvc3MtcmVnaW9uLWluZmVyZW5jZS1wcm9maWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2Nkay1saWIvYmVkcm9jay9pbmZlcmVuY2UtcHJvZmlsZXMvY3Jvc3MtcmVnaW9uLWluZmVyZW5jZS1wcm9maWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7Ozs7Ozs7Ozs7O0dBV0c7QUFDSCw2Q0FBa0Q7QUFDbEQsaURBQXdEO0FBRXhELHFDQUFtRTtBQUVuRSxJQUFZLGlDQTJCWDtBQTNCRCxXQUFZLGlDQUFpQztJQUMzQzs7Ozs7O09BTUc7SUFDSCw4Q0FBUyxDQUFBO0lBQ1Q7Ozs7OztPQU1HO0lBQ0gsOENBQVMsQ0FBQTtJQUNUOzs7Ozs7OztPQVFHO0lBQ0gsa0RBQWEsQ0FBQTtBQUNmLENBQUMsRUEzQlcsaUNBQWlDLGlEQUFqQyxpQ0FBaUMsUUEyQjVDO0FBa0JEOzsrRUFFK0U7QUFDL0U7Ozs7OztHQU1HO0FBQ0gsTUFBYSwyQkFBMkI7SUFDL0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUF3QztRQUMvRCxPQUFPLElBQUksMkJBQTJCLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDakQsQ0FBQztJQW9CRCxZQUFvQixLQUF1QztRQUN6RCxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1lBQ3JDLE1BQU0sSUFBSSxLQUFLLENBQUMsU0FBUyxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sMENBQTBDLENBQUMsQ0FBQztRQUMxRixDQUFDO1FBQ0QsSUFBSSxDQUFDLElBQUksR0FBRyw2QkFBb0IsQ0FBQyxjQUFjLENBQUM7UUFDaEQsSUFBSSxDQUFDLHFCQUFxQixHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUM7UUFDekMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLEdBQUcsS0FBSyxDQUFDLFNBQVMsSUFBSSxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ3RFLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxpQkFBRyxDQUFDLE1BQU0sQ0FBQztZQUNwQyxTQUFTLEVBQUUsaUJBQUcsQ0FBQyxTQUFTO1lBQ3hCLE9BQU8sRUFBRSxTQUFTO1lBQ2xCLE9BQU8sRUFBRSxpQkFBRyxDQUFDLFVBQVU7WUFDdkIsTUFBTSxFQUFFLGlCQUFHLENBQUMsTUFBTTtZQUNsQixRQUFRLEVBQUUsbUJBQW1CO1lBQzdCLFlBQVksRUFBRSxJQUFJLENBQUMsa0JBQWtCO1lBQ3JDLFNBQVMsRUFBRSx1QkFBUyxDQUFDLG1CQUFtQjtTQUN6QyxDQUFDLENBQUM7UUFDSCxpQ0FBaUM7UUFDakMsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUM7SUFDL0MsQ0FBQztJQUVEOztPQUVHO0lBQ0ksV0FBVyxDQUFDLE9BQW1CO1FBQ3BDLDhFQUE4RTtRQUM5RSxpREFBaUQ7UUFDakQsSUFBSSxDQUFDLHFCQUFxQixDQUFDLHFCQUFxQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzFELDRFQUE0RTtRQUM1RSxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsaUJBQWlCLENBQUMsT0FBbUI7UUFDbkMsTUFBTSxLQUFLLEdBQUcsZUFBSyxDQUFDLGNBQWMsQ0FBQztZQUNqQyxPQUFPLEVBQUUsT0FBTztZQUNoQixPQUFPLEVBQUUsQ0FBQyw2QkFBNkIsRUFBRSxxQkFBcUIsQ0FBQztZQUMvRCxZQUFZLEVBQUUsQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUM7U0FDekMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDOztBQWpFSCxrRUFrRUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqICBDb3B5cmlnaHQgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogIHdpdGggdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiAgb3IgaW4gdGhlICdsaWNlbnNlJyBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAnQVMgSVMnIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVNcbiAqICBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgQXJuLCBBcm5Gb3JtYXQsIEF3cyB9IGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCB7IEdyYW50LCBJR3JhbnRhYmxlIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWlhbSc7XG5pbXBvcnQgeyBCZWRyb2NrRm91bmRhdGlvbk1vZGVsLCBJSW52b2thYmxlIH0gZnJvbSAnLi4vbW9kZWxzJztcbmltcG9ydCB7IElJbmZlcmVuY2VQcm9maWxlLCBJbmZlcmVuY2VQcm9maWxlVHlwZSB9IGZyb20gJy4vY29tbW9uJztcblxuZXhwb3J0IGVudW0gQ3Jvc3NSZWdpb25JbmZlcmVuY2VQcm9maWxlUmVnaW9uIHtcbiAgLyoqXG4gICAqIENyb3NzLXJlZ2lvbiBJbmZlcmVuY2UgSWRlbnRpZmllciBmb3IgdGhlIEV1cm9wZWFuIGFyZWEuXG4gICAqIEFjY29yZGluZyB0byB0aGUgbW9kZWwgY2hvc2VuLCB0aGlzIG1pZ2h0IGluY2x1ZGU6XG4gICAqIC0gRnJhbmtmdXJ0IChgZXUtY2VudHJhbC0xYClcbiAgICogLSBJcmVsYW5kIChgZXUtd2VzdC0xYClcbiAgICogLSBQYXJpcyAoYGV1LXdlc3QtM2ApXG4gICAqL1xuICBFVSA9ICdldScsXG4gIC8qKlxuICAgKiBDcm9zcy1yZWdpb24gSW5mZXJlbmNlIElkZW50aWZpZXIgZm9yIHRoZSBVbml0ZWQgU3RhdGVzIGFyZWEuXG4gICAqIEFjY29yZGluZyB0byB0aGUgbW9kZWwgY2hvc2VuLCB0aGlzIG1pZ2h0IGluY2x1ZGU6XG4gICAqIC0gTi4gVmlyZ2luaWEgKGB1cy1lYXN0LTFgKVxuICAgKiAtIE9yZWdvbiAoYHVzLXdlc3QtMmApXG4gICAqIC0gT2hpbyAoYHVzLWVhc3QtMmApXG4gICAqL1xuICBVUyA9ICd1cycsXG4gIC8qKlxuICAgKiBDcm9zcy1yZWdpb24gSW5mZXJlbmNlIElkZW50aWZpZXIgZm9yIHRoZSBBc2lhLVBhY2lmaWMgYXJlYS5cbiAgICogQWNjb3JkaW5nIHRvIHRoZSBtb2RlbCBjaG9zZW4sIHRoaXMgbWlnaHQgaW5jbHVkZTpcbiAgICogLSBUb2t5byAoYGFwLW5vcnRoZWFzdC0xYClcbiAgICogLSBTZW91bCAoYGFwLW5vcnRoZWFzdC0yYClcbiAgICogLSBNdW1iYWkgKGBhcC1zb3V0aC0xYClcbiAgICogLSBTaW5nYXBvcmUgKGBhcC1zb3V0aGVhc3QtMWApXG4gICAqIC0gU3lkbmV5IChgYXAtc291dGhlYXN0LTJgKVxuICAgKi9cbiAgQVBBQyA9ICdhcGFjJyxcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogICAgICAgICAgICAgICAgICAgICAgICBQUk9QUyBGT1IgTkVXIENPTlNUUlVDVFxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuZXhwb3J0IGludGVyZmFjZSBDcm9zc1JlZ2lvbkluZmVyZW5jZVByb2ZpbGVQcm9wcyB7XG4gIC8qKlxuICAgKiBUaGUgZ2VvZ3JhcGhpYyByZWdpb24gd2hlcmUgdGhlIHRyYWZmaWMgaXMgZ29pbmcgdG8gYmUgZGlzdHJpYnV0ZWQuIFJvdXRpbmdcbiAgICogZmFjdG9ycyBpbiB1c2VyIHRyYWZmaWMsIGRlbWFuZCBhbmQgdXRpbGl6YXRpb24gb2YgcmVzb3VyY2VzLlxuICAgKi9cbiAgcmVhZG9ubHkgZ2VvUmVnaW9uOiBDcm9zc1JlZ2lvbkluZmVyZW5jZVByb2ZpbGVSZWdpb247XG4gIC8qKlxuICAgKiBBIG1vZGVsIHN1cHBvcnRpbmcgY3Jvc3MtcmVnaW9uIGluZmVyZW5jZS5cbiAgICogQHNlZSBodHRwczovL2RvY3MuYXdzLmFtYXpvbi5jb20vYmVkcm9jay9sYXRlc3QvdXNlcmd1aWRlL2Nyb3NzLXJlZ2lvbi1pbmZlcmVuY2Utc3VwcG9ydC5odG1sXG4gICAqL1xuICByZWFkb25seSBtb2RlbDogQmVkcm9ja0ZvdW5kYXRpb25Nb2RlbDtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogICAgICAgICAgICAgICAgICAgICAgICBORVcgQ09OU1RSVUNUIERFRklOSVRJT05cbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKlxuICogQ3Jvc3MtcmVnaW9uIGluZmVyZW5jZSBlbmFibGVzIHlvdSB0byBzZWFtbGVzc2x5IG1hbmFnZSB1bnBsYW5uZWQgdHJhZmZpY1xuICogYnVyc3RzIGJ5IHV0aWxpemluZyBjb21wdXRlIGFjcm9zcyBkaWZmZXJlbnQgQVdTIFJlZ2lvbnMuIFdpdGggY3Jvc3MtcmVnaW9uXG4gKiBpbmZlcmVuY2UsIHlvdSBjYW4gZGlzdHJpYnV0ZSB0cmFmZmljIGFjcm9zcyBtdWx0aXBsZSBBV1MgUmVnaW9ucywgZW5hYmxpbmdcbiAqIGhpZ2hlciB0aHJvdWdocHV0IGFuZCBlbmhhbmNlZCByZXNpbGllbmNlIGR1cmluZyBwZXJpb2RzIG9mIHBlYWsgZGVtYW5kcy5cbiAqIEBzZWUgaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL2JlZHJvY2svbGF0ZXN0L3VzZXJndWlkZS9jcm9zcy1yZWdpb24taW5mZXJlbmNlLmh0bWxcbiAqL1xuZXhwb3J0IGNsYXNzIENyb3NzUmVnaW9uSW5mZXJlbmNlUHJvZmlsZSBpbXBsZW1lbnRzIElJbnZva2FibGUsIElJbmZlcmVuY2VQcm9maWxlIHtcbiAgcHVibGljIHN0YXRpYyBmcm9tQ29uZmlnKGNvbmZpZzogQ3Jvc3NSZWdpb25JbmZlcmVuY2VQcm9maWxlUHJvcHMpOiBDcm9zc1JlZ2lvbkluZmVyZW5jZVByb2ZpbGUge1xuICAgIHJldHVybiBuZXcgQ3Jvc3NSZWdpb25JbmZlcmVuY2VQcm9maWxlKGNvbmZpZyk7XG4gIH1cbiAgLyoqXG4gICAqIEBleGFtcGxlICd1cy5hbnRocm9waWMuY2xhdWRlLTMtNS1zb25uZXQtMjAyNDA2MjAtdjE6MCdcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBpbmZlcmVuY2VQcm9maWxlSWQ6IHN0cmluZztcbiAgLyoqXG4gICAqIEBleGFtcGxlICdhcm46YXdzOmJlZHJvY2s6dXMtZWFzdC0xOjEyMzQ1Njc4OTAxMjppbmZlcmVuY2UtcHJvZmlsZS91cy5hbnRocm9waWMuY2xhdWRlLTMtNS1zb25uZXQtMjAyNDA2MjAtdjE6MCdcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBpbmZlcmVuY2VQcm9maWxlQXJuOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBAZXhhbXBsZSBJbmZlcmVuY2VQcm9maWxlVHlwZS5TWVNURU1fREVGSU5FRFxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IHR5cGU6IEluZmVyZW5jZVByb2ZpbGVUeXBlO1xuICAvKipcbiAgICogVGhlIHVuZGVybHlpbmcgbW9kZWwgc3VwcG9ydGluZyBjcm9zcy1yZWdpb24gaW5mZXJlbmNlLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGluZmVyZW5jZVByb2ZpbGVNb2RlbDogQmVkcm9ja0ZvdW5kYXRpb25Nb2RlbDtcbiAgLyoqIFRoaXMgZXF1YWxzIHRvIHRoZSBpbmZlcmVuY2VQcm9maWxlQXJuIHByb3BlcnR5LCB1c2VmdWwganVzdCB0byBpbXBsZW1lbnQgSUludm9rYWJsZSBpbnRlcmZhY2UqL1xuICBwdWJsaWMgcmVhZG9ubHkgaW52b2thYmxlQXJuOiBzdHJpbmc7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3Rvcihwcm9wczogQ3Jvc3NSZWdpb25JbmZlcmVuY2VQcm9maWxlUHJvcHMpIHtcbiAgICBpZiAoIXByb3BzLm1vZGVsLnN1cHBvcnRzQ3Jvc3NSZWdpb24pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTW9kZWwgJHtwcm9wcy5tb2RlbC5tb2RlbElkfSBkb2VzIG5vdCBzdXBwb3J0IGNyb3NzLXJlZ2lvbiBpbmZlcmVuY2VgKTtcbiAgICB9XG4gICAgdGhpcy50eXBlID0gSW5mZXJlbmNlUHJvZmlsZVR5cGUuU1lTVEVNX0RFRklORUQ7XG4gICAgdGhpcy5pbmZlcmVuY2VQcm9maWxlTW9kZWwgPSBwcm9wcy5tb2RlbDtcbiAgICB0aGlzLmluZmVyZW5jZVByb2ZpbGVJZCA9IGAke3Byb3BzLmdlb1JlZ2lvbn0uJHtwcm9wcy5tb2RlbC5tb2RlbElkfWA7XG4gICAgdGhpcy5pbmZlcmVuY2VQcm9maWxlQXJuID0gQXJuLmZvcm1hdCh7XG4gICAgICBwYXJ0aXRpb246IEF3cy5QQVJUSVRJT04sXG4gICAgICBzZXJ2aWNlOiAnYmVkcm9jaycsXG4gICAgICBhY2NvdW50OiBBd3MuQUNDT1VOVF9JRCxcbiAgICAgIHJlZ2lvbjogQXdzLlJFR0lPTixcbiAgICAgIHJlc291cmNlOiAnaW5mZXJlbmNlLXByb2ZpbGUnLFxuICAgICAgcmVzb3VyY2VOYW1lOiB0aGlzLmluZmVyZW5jZVByb2ZpbGVJZCxcbiAgICAgIGFybkZvcm1hdDogQXJuRm9ybWF0LlNMQVNIX1JFU09VUkNFX05BTUUsXG4gICAgfSk7XG4gICAgLy8gTmVlZGVkIHRvIEltcGxlbWVudCBJSW52b2thYmxlXG4gICAgdGhpcy5pbnZva2FibGVBcm4gPSB0aGlzLmluZmVyZW5jZVByb2ZpbGVBcm47XG4gIH1cblxuICAvKipcbiAgICogR2l2ZXMgdGhlIGFwcHJvcHJpYXRlIHBvbGljaWVzIHRvIGludm9rZSBhbmQgdXNlIHRoZSBGb3VuZGF0aW9uIE1vZGVsLlxuICAgKi9cbiAgcHVibGljIGdyYW50SW52b2tlKGdyYW50ZWU6IElHcmFudGFibGUpOiBHcmFudCB7XG4gICAgLy8gZm9yIENSSVMsIHdlIG5lZWQgdG8gcHJvdmlkZSBwZXJtaXNzaW9ucyB0byBpbnZva2UgdGhlIG1vZGVsIGluIGFsbCByZWdpb25zXG4gICAgLy8gd2hlcmUgdGhlIGluZmVyZW5jZSBwcm9maWxlIGNhbiByb3V0ZSByZXF1ZXN0c1xuICAgIHRoaXMuaW5mZXJlbmNlUHJvZmlsZU1vZGVsLmdyYW50SW52b2tlQWxsUmVnaW9ucyhncmFudGVlKTtcbiAgICAvLyBhbmQgd2UgbmVlZCB0byBwcm92aWRlIHBlcm1pc3Npb25zIHRvIGludm9rZSB0aGUgaW5mZXJlbmNlIHByb2ZpbGUgaXRzZWxmXG4gICAgcmV0dXJuIHRoaXMuZ3JhbnRQcm9maWxlVXNhZ2UoZ3JhbnRlZSk7XG4gIH1cblxuICAvKipcbiAgICogR3JhbnRzIGFwcHJvcHJpYXRlIHBlcm1pc3Npb25zIHRvIHVzZSB0aGUgY3Jvc3MtcmVnaW9uIGluZmVyZW5jZSBwcm9maWxlLlxuICAgKiBEb2VzIG5vdCBncmFudCBwZXJtaXNzaW9ucyB0byB1c2UgdGhlIG1vZGVsIGluIHRoZSBwcm9maWxlLlxuICAgKi9cbiAgZ3JhbnRQcm9maWxlVXNhZ2UoZ3JhbnRlZTogSUdyYW50YWJsZSk6IEdyYW50IHtcbiAgICBjb25zdCBncmFudCA9IEdyYW50LmFkZFRvUHJpbmNpcGFsKHtcbiAgICAgIGdyYW50ZWU6IGdyYW50ZWUsXG4gICAgICBhY3Rpb25zOiBbJ2JlZHJvY2s6R2V0SW5mZXJlbmNlUHJvZmlsZScsICdiZWRyb2NrOkludm9rZU1vZGVsJ10sXG4gICAgICByZXNvdXJjZUFybnM6IFt0aGlzLmluZmVyZW5jZVByb2ZpbGVBcm5dLFxuICAgIH0pO1xuICAgIHJldHVybiBncmFudDtcbiAgfVxufVxuIl19